{"ast":null,"code":"var _ = require('../helper');\n\nfunction assert(options, password) {\n  if (!password) {\n    return false;\n  }\n\n  var i,\n      current = {\n    c: null,\n    count: 0\n  };\n\n  for (i = 0; i < password.length; i++) {\n    if (current.c !== password[i]) {\n      current.c = password[i];\n      current.count = 1;\n    } else {\n      current.count++;\n    }\n\n    if (current.count > options.max) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction explain(options, verified) {\n  var example = new Array(options.max + 2).join('a');\n  var d = {\n    message: 'No more than %d identical characters in a row (e.g., \"%s\" not allowed)',\n    code: 'identicalChars',\n    format: [options.max, example]\n  };\n\n  if (verified !== undefined) {\n    d.verified = verified;\n  }\n\n  return d;\n}\n\nmodule.exports = {\n  validate: function validate(options) {\n    if (!_.isObject(options)) {\n      throw new Error('options should be an object');\n    }\n\n    if (!_.isNumber(options.max) || _.isNaN(options.max) || options.max < 1) {\n      throw new Error('max should be a number greater than 1');\n    }\n\n    return true;\n  },\n  explain: explain,\n  missing: function missing(options, password) {\n    return explain(options, assert(options, password));\n  },\n  assert: assert\n};","map":null,"metadata":{},"sourceType":"script"}